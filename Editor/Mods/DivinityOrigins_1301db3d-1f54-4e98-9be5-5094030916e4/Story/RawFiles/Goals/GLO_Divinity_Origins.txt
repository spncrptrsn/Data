Version 1
SubGoalCombiner SGC_AND
INITSECTION
DB_Origins_InitialRegion("FJ_FortJoy_Main");

DB_OriginRecruitmentDialog((CHARACTERGUID)CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Sebille_Recruitment");
DB_OriginRecruitmentDialog(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Lohse_Recruitment");
DB_OriginRecruitmentDialog(CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"RedPrince_Recruitment");
DB_OriginRecruitmentDialog(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Ifan_Recruitment");
DB_OriginRecruitmentDialog(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"Beast_Recruitment");
DB_OriginRecruitmentDialog(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"Fane_Recruitment");

// Override Origin-as-NPC dialog for a particular region. If none defined for the current region, the default is used
DB_OriginRecruitmentDialog_Region("TUT_Tutorial_A",(CHARACTERGUID)CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"TUT_LowerDeck_OriginSebille");
DB_OriginRecruitmentDialog_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"TUT_LowerDeck_OriginLohse");
DB_OriginRecruitmentDialog_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"TUT_LowerDeck_OriginRedPrince");
DB_OriginRecruitmentDialog_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"");
DB_OriginRecruitmentDialog_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"TUT_LowerDeck_OriginBeast");
DB_OriginRecruitmentDialog_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"TUT_LowerDeck_OriginFane");

DB_OriginInPartyDialog((CHARACTERGUID)CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"RedPrince");
DB_OriginInPartyDialog(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Sebille");
DB_OriginInPartyDialog(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Lohse");
DB_OriginInPartyDialog(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Ifan");
DB_OriginInPartyDialog(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"Beast");
DB_OriginInPartyDialog(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"Fane");

DB_OriginWarning1Dialog((CHARACTERGUID)CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"RedPrince_Warning1");
DB_OriginWarning1Dialog(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Sebille_Warning1");
DB_OriginWarning1Dialog(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Lohse_Warning1");
DB_OriginWarning1Dialog(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Ifan_Warning1");
DB_OriginWarning1Dialog(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"Beast_Warning1");
DB_OriginWarning1Dialog(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"Fane_Warning1");

DB_OriginWarning2Dialog((CHARACTERGUID)CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"RedPrince_Warning2");
DB_OriginWarning2Dialog(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Sebille_Warning2");
DB_OriginWarning2Dialog(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Lohse_Warning2");
DB_OriginWarning2Dialog(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Ifan_Warning2");
DB_OriginWarning2Dialog(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"Beast_Warning2");
DB_OriginWarning2Dialog(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"Fane_Warning2");

DB_OriginLeavingDialog((CHARACTERGUID)CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"RedPrince_Leaving");
DB_OriginLeavingDialog(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Sebille_Leaving");
DB_OriginLeavingDialog(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Lohse_Leaving");
DB_OriginLeavingDialog(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Ifan_Leaving");
DB_OriginLeavingDialog(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"Beast_Leaving");
DB_OriginLeavingDialog(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"Fane_Leaving");

// DB_OriginRecruitmentLocation_Region format:
//  Region, OriginCharacter, Location, behaviour script reaction 

//Tutorial Origin points
DB_OriginRecruitmentLocation_Region("TUT_Tutorial_A",(CHARACTERGUID)CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,(TRIGGERGUID)S_TUT_Origin_Sebille_Start_Point_14462739-fdbe-4704-aaf1-655e240f613c,"State_Tutorial");
DB_OriginRecruitmentLocation_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,S_TUT_Origin_RedPrince_Start_Point_92e3bf05-146a-4090-ac5b-649221f5aca7,"State_Tutorial");
DB_OriginRecruitmentLocation_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,S_TUT_Origin_Lohse_Start_Point_5ea7dc1b-9e72-4c8a-837d-9aaf0eb8ef75,"State_Tutorial");
DB_OriginRecruitmentLocation_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,S_TUT_Origin_Ifan_Start_Point_116a2f15-43ad-4ca8-9786-607a818f6abb,"State_Tutorial");
DB_OriginRecruitmentLocation_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,S_TUT_Origin_Beast_Start_Point_e43a2fe3-bb04-4883-8ebf-1a3277e89ebb,"State_Tutorial");
DB_OriginRecruitmentLocation_Region("TUT_Tutorial_A",CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,TRIGGERGUID_S_TUT_Origin_Fane_Start_Point_6b099337-511e-4e4b-bdc6-d98fbac599cf,"State_Tutorial");

// Fort Joy origin/recruitment points
DB_OriginRecruitmentLocation_Region("FJ_FortJoy_Main",(CHARACTERGUID)CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,(TRIGGERGUID)S_FTJ_Origin_SebilleDefault_Point_eefe4cdc-f44a-49c4-9a7a-f576a7a619a0,"State_FortJoy");
DB_OriginRecruitmentLocation_Region("FJ_FortJoy_Main",CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,TRIGGERGUID_S_FTJ_Origin_LohseDefault_Point_3edc40c9-0f63-416f-b664-1d4a605f4241,"State_FortJoy");
DB_OriginRecruitmentLocation_Region("FJ_FortJoy_Main",CHARACTERGUID_S_Player_Red_Prince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,TRIGGERGUID_S_FTJ_Origin_RedPrinceDefault_Point_5ed70405-47e0-46ee-9ce7-f5b2a6d5d770,"State_FortJoy");
DB_OriginRecruitmentLocation_Region("FJ_FortJoy_Main",CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,TRIGGERGUID_S_FTJ_Origin_IfanDefault_Point_811d43e1-5c27-4d00-aedf-51b629ac9dc8,"State_FortJoy");
DB_OriginRecruitmentLocation_Region("FJ_FortJoy_Main",CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,TRIGGERGUID_S_FTJ_Origin_BeastDefault_Point_2e7e34e8-290a-433b-8e0c-90d8579e7303,"State_FortJoy");
DB_OriginRecruitmentLocation_Region("FJ_FortJoy_Main",CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,TRIGGERGUID_S_FTJ_Origin_FaneDefault_Point_f0023da8-dbf4-4ed9-95be-7d0cd1ce183e,"State_FortJoy");

//Shelter Rrecruitment Point (not a separate region)
DB_OriginRecruitmentLocation_Region("__Shelter",(CHARACTERGUID)CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,(TRIGGERGUID)TRIGGERGUID_S_FTJ_SW_Origin_SebilleRecruit_Point_29f28941-3e5a-476e-a337-ee0548b0c797,"State_Shelter");
DB_OriginRecruitmentLocation_Region("__Shelter",CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,TRIGGERGUID_S_FTJ_SW_Origin_RedPrinceRecruit_Point_e633cf4a-d63d-456d-8ea9-95253fde2d77,"State_Shelter");
DB_OriginRecruitmentLocation_Region("__Shelter",CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,TRIGGERGUID_S_FTJ_SW_Origin_LohseRecruit_Point_76797d5b-996b-4c2e-a6b9-42e6770905dc,"State_Shelter");
DB_OriginRecruitmentLocation_Region("__Shelter",CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,TRIGGERGUID_S_FTJ_SW_Origin_IfanRecruit_Point_bd1ebe86-9911-4cd0-965e-414016db6799,"State_Shelter");
DB_OriginRecruitmentLocation_Region("__Shelter",CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,TRIGGERGUID_S_FTJ_SW_Origin_BeastRecruit_Point_56f6eaa1-ffde-4c8c-b473-c276b5e0e83b,"State_Shelter");
DB_OriginRecruitmentLocation_Region("__Shelter",CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,TRIGGERGUID_S_FTJ_SW_Origin_FaneRecruit_Point_fe0dfb2d-c56f-4c03-adf5-f69fd91a959f,"State_Shelter");

//Lady Vengeance Recruitment Point (and any level after)
DB_OriginRecruitmentLocation_Region("LV_HoE_Main",(CHARACTERGUID)CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,(TRIGGERGUID)TRIGGERGUID_S_GLO_LV_SebilleRecruit_Point_f660527c-54c7-4261-a38d-d843a53e3276,"State_LadyVengeance");
DB_OriginRecruitmentLocation_Region("LV_HoE_Main",CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,TRIGGERGUID_S_GLO_LV_RedPrinceRecruit_Point_6b01eba0-37d8-435e-8a1f-3b5cbcd06ba5,"State_LadyVengeance");
DB_OriginRecruitmentLocation_Region("LV_HoE_Main",CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,TRIGGERGUID_S_GLO_LV_LohseRecruit_Point_8839cc1e-ac6a-461e-a58b-9b10038d73b6,"State_LadyVengeance");
DB_OriginRecruitmentLocation_Region("LV_HoE_Main",CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,TRIGGERGUID_S_GLO_LV_IfanRecruit_Point_e00a315e-8ee3-4ce2-b52f-dae07a70af50,"State_LadyVengeance");
DB_OriginRecruitmentLocation_Region("LV_HoE_Main",CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,TRIGGERGUID_S_GLO_LV_BeastRecruit_Point_317b541d-c58d-48aa-b85b-7ef6fe580685,"State_LadyVengeance");
DB_OriginRecruitmentLocation_Region("LV_HoE_Main",CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,TRIGGERGUID_S_GLO_LV_FaneRecruit_Point_d7bc0df9-226c-4cdd-ad61-79a7e2c62e9a,"State_LadyVengeance");

DB_OriginRecruitmentLocation_Region("ARX_Endgame",(CHARACTERGUID)CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,(TRIGGERGUID)NULL_00000000-0000-0000-0000-000000000000,"");
DB_OriginRecruitmentLocation_Region("ARX_Endgame",CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,NULL_00000000-0000-0000-0000-000000000000,"");
DB_OriginRecruitmentLocation_Region("ARX_Endgame",CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,NULL_00000000-0000-0000-0000-000000000000,"");
DB_OriginRecruitmentLocation_Region("ARX_Endgame",CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,NULL_00000000-0000-0000-0000-000000000000,"");
DB_OriginRecruitmentLocation_Region("ARX_Endgame",CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,NULL_00000000-0000-0000-0000-000000000000,"");
DB_OriginRecruitmentLocation_Region("ARX_Endgame",CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,NULL_00000000-0000-0000-0000-000000000000,"");


DB_Origins_RecruitmenOnLVLevels("RC_Main");
DB_Origins_RecruitmenOnLVLevels("CoS_Main");
DB_Origins_RecruitmenOnLVLevels("ARX_Main");

//Do not remove these DB_s without replacing, even if one of them is an AVATAR
DB_OriginNPCAlignment((CHARACTERGUID)CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"Origin_RedPrince");
DB_OriginNPCAlignment(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Origin_Sebille");
DB_OriginNPCAlignment(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Origin_Lohse");
DB_OriginNPCAlignment(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Origin_Ifan");
DB_OriginNPCAlignment(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"Origin_Beast");
DB_OriginNPCAlignment(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"Origin_Fane");

GlobalSetFlag("GLO_LohseHasDemons"); // This is used in RC_DW_AD_UseMagicLute to check if Lohse still had the demon in her 

DB_OriginRelationChangeEvent("CompanionRelationUp2",2);
DB_OriginRelationChangeEvent("CompanionRelationUp5",5);
DB_OriginRelationChangeEvent("CompanionRelationUp10",10);
DB_OriginRelationChangeEvent("CompanionRelationUp15",15);
DB_OriginRelationChangeEvent("CompanionRelationUp20",20);
DB_OriginRelationChangeEvent("CompanionRelationUp30",30);
DB_OriginRelationChangeEvent("CompanionRelationUp40",40);
DB_OriginRelationChangeEvent("CompanionRelationUp50",50);
DB_OriginRelationChangeEvent("CompanionRelationDown2",-2);
DB_OriginRelationChangeEvent("CompanionRelationDown5",-5);
DB_OriginRelationChangeEvent("CompanionRelationDown10",-10);
DB_OriginRelationChangeEvent("CompanionRelationDown15",-15);
DB_OriginRelationChangeEvent("CompanionRelationDown20",-20);
DB_OriginRelationChangeEvent("CompanionRelationDown30",-30);
DB_OriginRelationChangeEvent("CompanionRelationDown40",-40);
DB_OriginRelationChangeEvent("CompanionRelationDown50",-50);
DB_OriginRelationChangeEvent("CompanionRelationDown1000",-1000); //Mostly for debug purposes, if you really want them to leave.

//Origin Relationship Balancing
DB_OriginRelationModifiers(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,3,5); //Ifan's events are only worth 60%

DB_OriginRelationThresholdEvents("GLO_Relationship_-40Plus",-40);
DB_OriginRelationThresholdEvents("GLO_Relationship_-30Plus",-30);
DB_OriginRelationThresholdEvents("GLO_Relationship_-20Plus",-20);
DB_OriginRelationThresholdEvents("GLO_Relationship_-10Plus",-10);
DB_OriginRelationThresholdEvents("GLO_Relationship_Positive",0);
DB_OriginRelationThresholdEvents("GLO_Relationship_10Plus",10);
DB_OriginRelationThresholdEvents("GLO_Relationship_20Plus",20);
DB_OriginRelationThresholdEvents("GLO_Relationship_30Plus",30);
DB_OriginRelationThresholdEvents("GLO_Relationship_40Plus",40);
DB_OriginRelationThresholdEvents("GLO_Relationship_50Plus",50);
DB_OriginRelationThresholdEvents("GLO_Relationship_60Plus",60);
DB_OriginRelationThresholdEvents("GLO_Relationship_70Plus",70);
DB_OriginRelationThresholdEvents("GLO_Relationship_80Plus",80);
DB_OriginRelationThresholdEvents("GLO_Relationship_90Plus",90);
DB_OriginRelationThresholdEvents("GLO_Relationship_100",100);

DB_OriginProfessionTags(CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"NOBLE");
DB_OriginProfessionTags(CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"SCHOLAR");

DB_OriginProfessionTags(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"NOBLE");
DB_OriginProfessionTags(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"BARBARIAN");

DB_OriginProfessionTags(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"MYSTIC");
DB_OriginProfessionTags(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"SCHOLAR");

DB_OriginProfessionTags(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"SOLDIER");
DB_OriginProfessionTags(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"OUTLAW");

DB_OriginProfessionTags(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"MYSTIC");
DB_OriginProfessionTags(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"JESTER");

DB_OriginProfessionTags(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"SCHOLAR");
DB_OriginProfessionTags(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"OUTLAW");

DB_OriginEquipmentSet((CHARACTERGUID)CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Enchanter");
DB_OriginEquipmentSet(CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"Fighter");
DB_OriginEquipmentSet(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Rogue");
DB_OriginEquipmentSet(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Wayfarer");
DB_OriginEquipmentSet(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"Battlemage");
DB_OriginEquipmentSet(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"Wizard");

//Quest Updates for Permadeath on Companions
DB_FormerCompanionDeath_QuestUpdate(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"QuestUpdate_FTJ_COM_Ifan_IfanDead");
DB_FormerCompanionDeath_QuestUpdate(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"QuestUpdate_FTJ_COM_Lohse_LohseDead");
DB_FormerCompanionDeath_QuestUpdate(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"QuestUpdate_FTJ_COM_Fane_FaneDead");
DB_FormerCompanionDeath_QuestUpdate(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"QuestUpdate_FTJ_COM_Sebille_SebilleDead");
DB_FormerCompanionDeath_QuestUpdate(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"QuestUpdate_FTJ_COM_Beast_BeastDead");
DB_FormerCompanionDeath_QuestUpdate(CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"QuestUpdate_FTJ_COM_RedPrince_RedPrinceDead");

DB_Companion_FixatedFlag((CHARACTERGUID)CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"GLO_RedPrince_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"GLO_Ifan_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"GLO_Sebille_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"GLO_Lohse_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"GLO_Beast_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"GLO_Fane_Avatar");
KBSECTION
//REGION Debug
IF
TextEventSet("lohseleave")
THEN
PROC_GLO_PartyMembers_MakeNPC(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295);

//END_REGION

//REGION Recruitment points are always on the LV after LV_HoE_Main
IF
DB_OriginRecruitmentLocation_Region("LV_HoE_Main",_Origin,_Trigger,_State)
AND
DB_Origins_RecruitmenOnLVLevels(_Level)
THEN
DB_OriginRecruitmentLocation_Region(_Level,_Origin,_Trigger,_State);
//END_REGION

//REGION Transition from tutorial to Fort Joy
// Special case: when coming from Tutorial to Fort Joy, all players and origins must have full health
PROC
PROC_GLO_OriginNPCInitForRegion("FJ_FortJoy_Main")
AND
DB_OriginRecruitmentLocation(_Char,_Trigger)
AND
NOT DB_IsPlayer(_Char)
AND
CharacterIsDead(_Char,0)
THEN
CharacterSetHitpointsPercentage(_Char,100.0);

PROC
PROC_GLO_OriginNPCInitForRegion("FJ_FortJoy_Main")
AND
DB_IsPlayer(_Char)
AND
CharacterIsDead(_Char,0)
THEN
CharacterSetHitpointsPercentage(_Char,100.0);

// Special case: when coming from Tutorial to Fort Joy, dead origins not in the party have to be revived
PROC
PROC_GLO_OriginNPCInitForRegion("FJ_FortJoy_Main")
AND
DB_OriginRecruitmentLocation(_Char,_Trigger)
AND
NOT DB_IsPlayer(_Char)
AND
CharacterIsDead(_Char,1)
AND
GetRegion(_Char,"TUT_Tutorial_A")
THEN
DB_GLO_OriginNPCResurrectedForFortJoy(_Char);
CharacterResurrect(_Char);
TeleportTo(_Char,_Trigger);

IF
CharacterResurrected(_Char)
AND
DB_GLO_OriginNPCResurrectedForFortJoy(_Char)
AND
DB_OriginInitialPreset(_Char,_Preset)
THEN
NOT DB_OriginInitialPreset(_Char,_Preset);
// In case they were robbed nekid by enterprising players
ObjectSetFlag(_Char,_Preset);

//Reset any attitude changes that might have occurred during tutorial combat.
PROC
PROC_GLO_OriginNPCInitForRegion("FJ_FortJoy_Main")
AND
DB_OriginRecruitmentLocation(_Char,_Trigger)
AND
NOT DB_IsPlayer(_Char)
AND
DB_Avatars(_Avatar)
AND
CharacterGetAttitudeTowardsPlayer(_Char,(CHARACTERGUID)_Avatar,_Att)
AND
IntegerProduct(_Att,-1,_MinAtt)
THEN
CharacterAddAttitudeTowardsPlayer(_Char,_Avatar,_MinAtt);
//END_REGION

//REGION Source powers
PROC
PROC_GLO_PartyMembers_AddHook((CHARACTERGUID)_Origin,(CHARACTERGUID)_Player)
THEN
Proc_UnlockSourcePointsAndPowers(_Origin,_Player);

PROC
Proc_UnlockSourcePointsAndPowers((CHARACTERGUID)_Companion,(CHARACTERGUID)_Avatar)
AND
CharacterGetMaxSourcePoints(_Companion,_CompanionSP)
AND
CharacterGetMaxSourcePoints(_Avatar,2)
AND
_CompanionSP < 2
THEN
ObjectSetFlag(_Companion,"GLO_Has2MaxMP");
CharacterOverrideMaxSourcePoints(_Companion,2);

PROC
Proc_UnlockSourcePointsAndPowers((CHARACTERGUID)_Companion,(CHARACTERGUID)_Avatar)
AND
CharacterGetMaxSourcePoints(_Companion,_CompanionSP)
AND
CharacterGetMaxSourcePoints(_Avatar,3)
AND
_CompanionSP < 3
THEN
ObjectSetFlag(_Companion,"GLO_Has2MaxMP");
ObjectSetFlag(_Companion,"GLO_Has3MaxMP");
CharacterOverrideMaxSourcePoints(_Companion,3);

PROC
Proc_UnlockSourcePointsAndPowers((CHARACTERGUID)_Companion,(CHARACTERGUID)_Avatar)
AND
ObjectGetFlag(_Avatar,"GLO_HasSpiritVision",1)
AND
ObjectGetFlag(_Companion,"GLO_HasSpiritVision",0)
THEN
CharacterAddSkill(_Companion,"Shout_SpiritVision");

PROC
Proc_UnlockSourcePointsAndPowers((CHARACTERGUID)_Companion,(CHARACTERGUID)_Avatar)
AND
ObjectGetFlag(_Avatar,"GLO_HasSourceVampirism",1)
AND
ObjectGetFlag(_Companion,"GLO_HasSourceVampirism",0)
THEN
CharacterAddSkill(_Companion,"Target_SourceVampirism");

PROC
Proc_UnlockSourcePointsAndPowers((CHARACTERGUID)_Companion,(CHARACTERGUID)_Avatar)
AND
ObjectGetFlag(_Avatar,"RC_DW_Meistr_KnowCoS",1)
THEN
ObjectSetFlag(_Companion,"GLO_HasSourceVampirism");
//END_REGION

//REGION New Companion Dialog for Act 2
IF
DB_Chapter(_Player,_Chapter)
AND
_Chapter >= 5
THEN
NOT DB_OriginInPartyDialog(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Ifan");
DB_OriginInPartyDialog((CHARACTERGUID)CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Ifan2");
NOT DB_OriginInPartyDialog(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Lohse");
DB_OriginInPartyDialog((CHARACTERGUID)CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Lohse2");
NOT DB_OriginInPartyDialog(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Sebille");
DB_OriginInPartyDialog((CHARACTERGUID)CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Sebille2");
NOT DB_OriginInPartyDialog(CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"RedPrince");
DB_OriginInPartyDialog((CHARACTERGUID)CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"RedPrince2");


IF
DB_Chapter(_Player,_Chapter)
AND
_Chapter >= 5
AND
DB_Dialogs(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Ifan")
THEN
PROC_GLO_PartyMembers_SetInpartyDialog(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"Ifan2");

IF
DB_Chapter(_Player,_Chapter)
AND
_Chapter >= 5
AND
DB_Dialogs(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Lohse")
THEN
PROC_GLO_PartyMembers_SetInpartyDialog(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"Lohse2");

IF
DB_Chapter(_Player,_Chapter)
AND
_Chapter >= 5
AND
DB_Dialogs(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Sebille")
THEN
PROC_GLO_PartyMembers_SetInpartyDialog(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"Sebille2");

IF
DB_Chapter(_Player,_Chapter)
AND
_Chapter >= 5
AND
DB_Dialogs(CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"RedPrince")
THEN
PROC_GLO_PartyMembers_SetInpartyDialog(CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"RedPrince2");
//END_REGION


IF
SavegameLoaded(_Major,_Minor,_Rev,_Build)
AND
QRY_VersionIsOlderThan(_Major,_Minor,_Rev,_Build, 3, 5, 1, 0)
THEN
DB_Companion_FixatedFlag((CHARACTERGUID)CHARACTERGUID_S_Player_RedPrince_a26a1efb-cdc8-4cf3-a7b2-b2f9544add6f,"GLO_RedPrince_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Ifan_ad9a3327-4456-42a7-9bf4-7ad60cc9e54f,"GLO_Ifan_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Sebille_c8d55eaf-e4eb-466a-8f0d-6a9447b5b24c,"GLO_Sebille_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Lohse_bb932b13-8ebf-4ab4-aac0-83e6924e4295,"GLO_Lohse_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Beast_f25ca124-a4d2-427b-af62-df66df41a978,"GLO_Beast_Avatar");
DB_Companion_FixatedFlag(CHARACTERGUID_S_Player_Fane_02a77f1f-872b-49ca-91ab-32098c443beb,"GLO_Fane_Avatar");
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "DOS2ModWrapper"
