Version 1
SubGoalCombiner SGC_AND
INITSECTION
DB_Ghosts(CHARACTERGUID_S_RC_MIL_Mupper_f18d4f11-3c64-40a1-8dab-dff0e6c865d6, CHARACTERGUID_S_RC_MIL_Mupper_Ghost_f1067146-b1bd-43e4-9724-5956ca7406ce, "RC_MIL_Mupper");
DB_Ghosts(CHARACTERGUID_S_RC_MIL_GuardWolf1Haunt_c6afcb8a-8cf0-4a71-be0d-bbfd5e021a80, "RC_MIL_GuardWolf1Haunt");
DB_Ghosts(CHARACTERGUID_S_RC_MIL_RanjaHaunt_6a621d65-9bf1-4fb9-80ab-0c4e157983e7, "RC_MIL_RanjaHaunt");
DB_Ghosts(CHARACTERGUID_S_RC_MIL_ShSh1Haunt_1d524731-f810-450b-ae86-d17ad5cc5f5e, "RC_MIL_ShSh1Haunt");
DB_Ghosts(CHARACTERGUID_S_RC_MIL_ShSh2Haunt_38e2408d-03cd-4976-8109-e06c98ce90be, "RC_MIL_ShSh2Haunt");
DB_Ghosts(CHARACTERGUID_S_RC_MIL_SelenHaunt_e75b9c54-b497-4ac4-8c63-214a7f70a887, "RC_MIL_SelenHaunt");
DB_Ghosts(CHARACTERGUID_S_RC_MIL_CalseHaunt_65a14cb5-2b88-40d1-a236-a71f6379c092, "RC_MIL_CalseHaunt");
DB_Ghosts(CHARACTERGUID_S_RC_MIL_LoneWolf2Haunt_34f85c6c-6fe6-48a7-b5ba-c5a009c85bfb, "RC_MIL_LoneWolf2Haunt");


DB_RC_MIL_GhostSuckUpdates(CHARACTERGUID_S_RC_MIL_GuardWolf1Haunt_c6afcb8a-8cf0-4a71-be0d-bbfd5e021a80, "QuestUpdate_RC_MIL_SyrusOates_GhostSucked");
DB_RC_MIL_GhostSuckUpdates(CHARACTERGUID_S_RC_MIL_RanjaHaunt_6a621d65-9bf1-4fb9-80ab-0c4e157983e7, "QuestUpdate_RC_MIL_BlackWidowMaker_GhostSucked");
DB_RC_MIL_GhostSuckUpdates(CHARACTERGUID_S_RC_MIL_ShSh2Haunt_38e2408d-03cd-4976-8109-e06c98ce90be, "QuestUpdate_RC_MIL_EdieEngrym_GhostSucked");
DB_RC_MIL_GhostSuckUpdates(CHARACTERGUID_S_RC_MIL_ShSh1Haunt_1d524731-f810-450b-ae86-d17ad5cc5f5e, "QuestUpdate_RC_MIL_GhostRevenge_GhostSucked");
DB_RC_MIL_GhostSuckUpdates(CHARACTERGUID_S_RC_MIL_LoneWolf2Haunt_34f85c6c-6fe6-48a7-b5ba-c5a009c85bfb, "QuestUpdate_RC_MIL_Mudbarrow_GhostSucked");

/*DB_RC_MIL_LoneWolfGhosts((CHARACTERGUID)CHARACTERGUID_S_RC_MIL_Mupper_Ghost_f1067146-b1bd-43e4-9724-5956ca7406ce);
DB_RC_MIL_LoneWolfGhosts((CHARACTERGUID)CHARACTERGUID_S_RC_MIL_GuardWolf2Haunt_c6afcb8a-8cf0-4a71-be0d-bbfd5e021a80);
DB_RC_MIL_LoneWolfGhosts(CHARACTERGUID_S_RC_MIL_RanjaHaunt_6a621d65-9bf1-4fb9-80ab-0c4e157983e7);
DB_RC_MIL_LoneWolfGhosts(CHARACTERGUID_S_RC_MIL_SelenHaunt_e75b9c54-b497-4ac4-8c63-214a7f70a887);
DB_RC_MIL_LoneWolfGhosts(CHARACTERGUID_S_RC_MIL_ShSh1Haunt_1d524731-f810-450b-ae86-d17ad5cc5f5e);
DB_RC_MIL_LoneWolfGhosts(CHARACTERGUID_S_RC_MIL_ShSh2Haunt_38e2408d-03cd-4976-8109-e06c98ce90be);
DB_RC_MIL_LoneWolfGhosts(CHARACTERGUID_S_RC_MIL_CalseHaunt_65a14cb5-2b88-40d1-a236-a71f6379c092);
DB_RC_MIL_LoneWolfGhosts(CHARACTERGUID_S_RC_MIL_LoneWolf2Haunt_34f85c6c-6fe6-48a7-b5ba-c5a009c85bfb);*/

/*DB_HauntedNPC(CHARACTERGUID_S_RC_MIL_GuardWolf1_dd6de19c-bcce-40d3-b4ce-522a735e4fee, CHARACTERGUID_S_RC_MIL_GuardWolf1Haunt_c6afcb8a-8cf0-4a71-be0d-bbfd5e021a80);
DB_HauntedNPC(CHARACTERGUID_S_RC_MIL_LizardWolf_3e69ef2b-3fa8-4e26-8117-2fec05c4d9a9, CHARACTERGUID_S_RC_MIL_RanjaHaunt_6a621d65-9bf1-4fb9-80ab-0c4e157983e7);
DB_HauntedNPC(CHARACTERGUID_S_RC_MIL_Sharpshooter2_a0f76bb6-2935-44fd-a66f-13198a10260d, CHARACTERGUID_S_RC_MIL_ShSh2Haunt_38e2408d-03cd-4976-8109-e06c98ce90be);
//DB_HauntedNPC(CHARACTERGUID_S_RC_MIL_DwarfWolfM_9e42d7db-c8d3-4ef3-889b-99f78f95d715, CHARACTERGUID_S_RC_MIL_CalseHaunt_65a14cb5-2b88-40d1-a236-a71f6379c092);
DB_HauntedNPC(CHARACTERGUID_S_RC_MIL_DwarfWolf_18352a24-4b55-4fa5-ba9f-e6d347336d6e, CHARACTERGUID_S_RC_MIL_SelenHaunt_e75b9c54-b497-4ac4-8c63-214a7f70a887);
DB_HauntedNPC(CHARACTERGUID_S_RC_MIL_LoneWolf2_49413cc0-7439-48c8-b5fc-375794243b7f, CHARACTERGUID_S_RC_MIL_LoneWolf2Haunt_34f85c6c-6fe6-48a7-b5ba-c5a009c85bfb);*/

DB_DeadEvent(CHARACTERGUID_S_RC_MIL_GuardWolf1_dd6de19c-bcce-40d3-b4ce-522a735e4fee, "RC_MIL_GuardWolf1_Dead");
DB_DeadEvent(CHARACTERGUID_S_RC_MIL_LizardWolf_3e69ef2b-3fa8-4e26-8117-2fec05c4d9a9, "RC_MIL_LizardWolf1_Dead");
DB_DeadEvent(CHARACTERGUID_S_RC_MIL_Sharpshooter2_a0f76bb6-2935-44fd-a66f-13198a10260d, "RC_MIL_SharpShooter2_Dead");
DB_DeadEvent(CHARACTERGUID_S_RC_MIL_LoneWolf2_49413cc0-7439-48c8-b5fc-375794243b7f, "RC_MIL_LoneWolf2_Dead");
DB_DeadEvent(CHARACTERGUID_S_RC_MIL_DwarfWolf_18352a24-4b55-4fa5-ba9f-e6d347336d6e, "RC_MIL_DwarfWolf_Dead");

DB_KilledEvent(CHARACTERGUID_S_RC_MIL_GuardWolf1_dd6de19c-bcce-40d3-b4ce-522a735e4fee, "RC_MIL_KilledGuardWolf1");
DB_KilledEvent(CHARACTERGUID_S_RC_MIL_LizardWolf_3e69ef2b-3fa8-4e26-8117-2fec05c4d9a9, "RC_MIL_KilledLizardWolf");
DB_KilledEvent(CHARACTERGUID_S_RC_MIL_Sharpshooter2_a0f76bb6-2935-44fd-a66f-13198a10260d, "RC_MIL_KilledSharpshooter2");
DB_KilledEvent(CHARACTERGUID_S_RC_MIL_DwarfWolf_18352a24-4b55-4fa5-ba9f-e6d347336d6e, "RC_MIL_KilledDwarfWolf");
DB_KilledEvent(CHARACTERGUID_S_RC_MIL_LoneWolf2_49413cc0-7439-48c8-b5fc-375794243b7f, "RC_MIL_KilledLoneWolf2");
DB_KilledEvent(CHARACTERGUID_S_RC_MIL_Sharpshooter1_31fc7260-d0d9-4290-a2b1-fcd23c431d61, "RC_MIL_KilledShSh1");
DB_DeadEvent(CHARACTERGUID_S_RC_MIL_Sharpshooter1_31fc7260-d0d9-4290-a2b1-fcd23c431d61, "RC_MIL_SharpShooter1Dead");

DB_RC_MIL_GhostSkillRewards("RC_MIL_GivePressureSpike", "Target_PressureSpike");
DB_RC_MIL_GhostSkillRewards("RC_MIL_GiveGlobalCooling", "Shout_GlobalCooling");
DB_RC_MIL_GhostSkillRewards("RC_MIL_GiveEarthquake", "Quake_Earthquake");

SetOnStage(S_RC_MIL_SelenHead_468156b2-7c88-4305-bb39-55fcdbdb0652, 0);
SetOnStage(ITEMGUID_S_RC_MIL_LogRewardShield_4a39c5bb-abb6-42d5-b064-f39053b2c43e, 0);

DB_PossessedItem(ITEMGUID_S_RC_MIL_GhostLog_e75084d9-e7c5-4e6b-8b31-d834e7c8747a, ITEMGUID_S_RC_MIL_GhostLog_Ghost_ede68b3f-cd45-474b-8645-0dfaa706c3ff, "RC_MIL_GhostLog", "RC_MIL_GhostLog_SeeAura");
CharacterSetFightMode(CHARACTERGUID_S_RC_MIL_SelenHaunt_e75b9c54-b497-4ac4-8c63-214a7f70a887, 1, 1);

DB_ShovelArea(TRIGGERGUID_S_RC_MIL_GraveyardBox1_9777a567-818b-4369-bf82-0d9d9747973f,"RC_MIL_Graveyard1",ITEMGUID_S_RC_MIL_GraveyardPile1_dd600992-87ee-40c7-a3ce-19acb5fa2862);
DB_ShovelArea(TRIGGERGUID_S_RC_MIL_GraveyardBox2_6110eaec-921d-4c92-9da1-87e3a5b59483,"RC_MIL_Graveyard2",ITEMGUID_S_RC_MIL_GraveyardPile2_f18ea3d9-f0ec-4948-9aad-a891d034f686);
DB_ShovelArea(TRIGGERGUID_S_RC_MIL_GraveyardBox3_e36c8b39-7e02-48f0-9f79-9103df37935f,"RC_MIL_Graveyard3",ITEMGUID_S_RC_MIL_GraveyardPile3_b0b408b7-6527-46db-8e95-bfbeddc6aab9);

DB_Ghosts(S_RC_MIL_MillOverseer_bd2a58fc-2e61-4a62-b79c-6ff952888fc4, S_RC_MIL_MillOverseer_Ghost_9d107991-3bb8-4b3a-894a-f17fc83b59f7, "RC_MIL_MillOverseer");
DB_ShovelRewardSurface("RC_MIL_Graveyard2",S_RC_MIL_GraveyardBox2_6110eaec-921d-4c92-9da1-87e3a5b59483, "SurfacePoison", 2.5, -1.0);
DB_ShovelRewardItemAppear("RC_MIL_Graveyard3",S_RC_MIL_GraveyardReward_7e8de25b-af19-4cc9-beb5-cebb3802d7a8,S_RC_MIL_Graveyard3Dest_1503f012-fd0f-4a5b-bb4d-ac094a0f7370);
SetOnStage(CHARACTERGUID_S_RC_MIL_MillOverseer_bd2a58fc-2e61-4a62-b79c-6ff952888fc4, 0);

DB_IsSign(ITEMGUID_S_RC_MIL_GraveyardStone1_81c255c7-23f7-4809-ad4e-937cbe57f07e,"RC_MIL_GraveyardStone","RC_MIL_Stone1");
DB_IsSign(ITEMGUID_S_RC_MIL_GraveyardStone2_e05a7c71-e8e3-4617-9591-5183f94a6051,"RC_MIL_GraveyardStone","RC_MIL_Stone2");
DB_IsSign(ITEMGUID_S_RC_MIL_GraveyardStone3_285de4e4-16b9-47c8-8bc0-af1ed002449b,"RC_MIL_GraveyardStone","RC_MIL_Stone3");

DB_QuestDef_State("RC_MIL_GhostLog", "GotQuest", 1);
DB_QuestDef_UpdateEvent("RC_MIL_GhostLog","KilledMillSupervisor","RC_MIL_KilledMillSupervisor");
DB_QuestDef_State("RC_MIL_GhostLog", "GotReward", 1);
DB_QuestDef_State("RC_MIL_GhostLog", "CloseLeftRC", -1);

DB_QuestDef_CloseEvent("RC_MIL_GhostLog", "QuestUpdate_RC_MIL_GhostLog_GotReward");

DB_QuestDef_State("RC_MIL_GhostRevenge", "GotQuest", 1);
DB_QuestDef_UpdateEvent("RC_MIL_GhostRevenge","KilledShSh1","RC_MIL_KilledShSh1");
DB_QuestDef_State("RC_MIL_GhostRevenge", "GotReward", 1);
DB_QuestDef_State("RC_MIL_GhostRevenge", "GhostSucked", -1);
DB_QuestDef_State("RC_MIL_GhostRevenge", "CloseLeftRC", -1);

DB_QuestDef_CloseEvent("RC_MIL_GhostRevenge", "QuestUpdate_RC_MIL_GhostRevenge_GotReward");

DB_ShovelArea(TRIGGERGUID_S_RC_MIL_LoneWolf2CacheBox_5bb20eb1-1dee-4326-bb6b-d11d848b54b7,"RC_MIL_LoneWolf2Cache",ITEMGUID_S_RC_MIL_LoneWolf2CachePile_97b20d71-cc63-41e1-bea3-65dd748631a2);
DB_ShovelRewardItemAppear("RC_MIL_LoneWolf2Cache",ITEMGUID_S_RC_MIL_LoneWolf2Cache_d824e14b-c0d0-460e-a710-be0287e900b5,TRIGGERGUID_S_RC_MIL_LoneWolf2CacheDest_462de0e4-4903-44af-96b5-917044d5cd55);

DB_Dialogs(CHARACTERGUID_S_RC_MIL_IndoorSquirrel_cef7f23c-606a-4fa3-bb27-45a01ca68cf6, "RC_MIL_IndoorSquirrel");
DB_Dialogs(CHARACTERGUID_S_RC_MIL_SawmillSquirrel_debe56fc-d7b4-49e4-93bb-213e7abbfc2f, "RC_MIL_SawmillSquirrel");
DB_Dialogs(CHARACTERGUID_S_RC_MIL_ForestSquirrel_2939c8ae-6830-451c-a45f-fd5d910e1748, "RC_MIL_ForestSquirrel");
DB_Dialogs(CHARACTERGUID_S_RC_MIL_Frog_7c20afd5-e05b-4fc1-ae35-fefbdc80ea21, "RC_MIL_Frog");

DB_HasStoryEvent(ITEMGUID_S_RC_MIL_SelenHead_468156b2-7c88-4305-bb39-55fcdbdb0652, "RC_MIL_HasSelenHead");
DB_GiveItemToEventWithClear(ITEMGUID_S_RC_MIL_SelenHead_468156b2-7c88-4305-bb39-55fcdbdb0652, "RC_MIL_GiveSelenHead");

DB_QuestDef_AddEvent("RC_MIL_SelenHead","RC_MIL_AskedSelenHaunt");
DB_QuestDef_UpdateEvent("RC_MIL_SelenHead", "GotQuest","RC_MIL_AskedSelenHaunt");
DB_QuestDef_State("RC_MIL_SelenHead", "GotHead");
DB_QuestDef_QuestReward("RC_MIL_SelenHead", "QuestReward", "QuestUpdate_RC_MIL_SelenHead_QuestReward");
DB_QuestDef_State("RC_MIL_SelenHead", "Delivered", -1);
DB_QuestDef_State("RC_MIL_SelenHead", "Fail", -1);
DB_QuestDef_State("RC_MIL_SelenHead", "CloseLeftRC", -1);
DB_QuestDef_State("RC_MIL_SelenHead", "AteHead", -1);

DB_KilledEvent(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22,"QuestUpdate_RC_MIL_SavingCorbin_CorbinDead");
DB_DeadEvent(CHARACTERGUID_S_RC_MIL_DwarfWolfM_9e42d7db-c8d3-4ef3-889b-99f78f95d715, "RC_MIL_DwarfWolfMDead");
DB_KilledEvent(CHARACTERGUID_S_RC_MIL_DwarfWolfM_9e42d7db-c8d3-4ef3-889b-99f78f95d715, "RC_MIL_KilledDwarfWolfM");
CharacterSetCanTrade(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22,0);

DB_RC_MIL_LoneWolvesDownstairs((CHARACTERGUID)S_RC_MIL_LizardWolf_3e69ef2b-3fa8-4e26-8117-2fec05c4d9a9);
DB_RC_MIL_LoneWolvesDownstairs((CHARACTERGUID)S_RC_MIL_LoneWolfF_cecf1eb8-1ff8-425f-8859-91482edb9eb6);
DB_RC_MIL_LoneWolvesDownstairs(S_RC_MIL_DwarfWolf_18352a24-4b55-4fa5-ba9f-e6d347336d6e);
DB_RC_MIL_LoneWolvesDownstairs(CHARACTERGUID_S_RC_MIL_DwarfWolfM_9e42d7db-c8d3-4ef3-889b-99f78f95d715);
DB_RC_MIL_LoneWolvesDownstairs(CHARACTERGUID_S_RC_MIL_LoneWolf2_49413cc0-7439-48c8-b5fc-375794243b7f);
DB_RC_MIL_LoneWolvesDownstairs((CHARACTERGUID)S_RC_MIL_SharpShooter1_31fc7260-d0d9-4290-a2b1-fcd23c431d61);
DB_RC_MIL_LoneWolvesDownstairs(S_RC_MIL_Sharpshooter2_a0f76bb6-2935-44fd-a66f-13198a10260d);
DB_RC_MIL_LoneWolvesDownstairs(S_RC_MIL_GuardWolf1_dd6de19c-bcce-40d3-b4ce-522a735e4fee);
DB_RC_MIL_LoneWolvesDownstairs(S_RC_MIL_GuardWolf2_c55778a5-fa1f-484d-86d2-dc625d51ca59);

DB_SeenDeadNPCPartyFlag(CHARACTERGUID_S_RC_DF_Paladin_1_e732339e-28b6-4736-bbad-a6fdcceca684, "QuestUpdate_RC_MIL_SelenHead_Fail");
KBSECTION
// Lone wolves cannot be bribed
QRY
QRY_CrimeBribes_DisableBribe((INTEGER)_CrimeID,(CHARACTERGUID)_Interrogator,(CHARACTERGUID)_Criminal,(STRING)_Dialog)
AND
IsTagged(_Interrogator,"LONEWOLF",1)
THEN
DB_NOOP(1);


IF
CharacterDying(_Wolf)
AND
DB_RC_MIL_LoneWolvesDownstairs(_Wolf)
AND
NOT QRY_RC_MIL_OtherLoneWolvesAlive(_Wolf)
THEN
GlobalSetFlag("RC_MIL_AllLoneWolvesDead");

IF
GlobalFlagSet("RC_MIL_AllLoneWolvesDead")
AND
DB_IsPlayer(_Player)
AND
UserGetFlag(_Player,"QuestUpdate_RC_MIL_SavingCorbin_CorbinMet",1)
THEN
UserSetFlag(_Player,"QuestUpdate_RC_MIL_SavingCorbin_LWDead");

QRY
QRY_RC_MIL_OtherLoneWolvesAlive((CHARACTERGUID)_Wolf)
AND
DB_RC_MIL_LoneWolvesDownstairs(_OtherWolf)
AND
CharacterIsDead(_OtherWolf, 0)
THEN
DB_NOOP(1);

IF
CharacterSawCharacter(_Player, _Ghost)
AND
DB_IsPlayer(_Player)
AND
DB_RC_MIL_LoneWolfGhosts(_Ghost)
THEN
UserSetFlag(_Player, "RC_MIL_SawSawmillGhost", 0);


//REGION Wizard who wants you to kill one of the Sharpshooters.
IF
ObjectFlagSet(_Flag, _Player, _)
AND
DB_RC_MIL_GhostSkillRewards(_Flag, _Skill)
THEN
CharacterAddSkill((CHARACTERGUID)_Player, _Skill);
//END_REGION

//REGION Mummy Dearest Head
IF
CharacterDying(CHARACTERGUID_S_RC_MIL_DwarfWolf_18352a24-4b55-4fa5-ba9f-e6d347336d6e)
THEN
ItemToInventory(S_RC_MIL_SelenHead_468156b2-7c88-4305-bb39-55fcdbdb0652, CHARACTERGUID_S_RC_MIL_DwarfWolf_18352a24-4b55-4fa5-ba9f-e6d347336d6e);
SetOnStage(ITEMGUID_S_RC_MIL_SelenHead_468156b2-7c88-4305-bb39-55fcdbdb0652, 1);

IF
CharacterUsedItem(_Player, S_RC_MIL_SelenHead_468156b2-7c88-4305-bb39-55fcdbdb0652)
THEN
PartySetFlag(_Player, "QuestUpdate_RC_MIL_SelenHead_AteHead");
//END_REGION

//REGION Corbin Day
IF
ObjectFlagSet("RC_MIL_SavingCorbin_GiveReward",(CHARACTERGUID)_Player,_)
AND
CharacterGetEquippedWeapon(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22,(ITEMGUID)_Weapon)
THEN
CharacterGiveReward(_Player,"RC_MIL_CorbinsReward");
CharacterUnequipItem(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22,_Weapon);

IF
DialogEnded("RC_MIL_LoneWolf1", _)
AND
ObjectGetFlag(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, "RC_MIL_CorbinToLV", 1)
AND
ObjectIsInTrigger(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, TRIGGERGUID_LevelBoundTrigger_72af11dc-e42f-4133-8b3b-6b4ea6e403f3, 0)
THEN
ProcCharacterDisableAllCrimes(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22);
SetHasDialog(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, 0);
ProcCharacterDisappearOutOfSight(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, 0, 0, "RC_MIL_CorbinDayToLV", 0);

IF
StoryEvent(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, "RC_MIL_CorbinDayToLV")
THEN
CharacterAppearOutOfSightTo(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, TRIGGERGUID_S_GLO_LV_CorbinRecruit_Point_5c66222c-e380-48b5-98a3-892d9cd577d0, 90, 0, "RC_CorbinAppearedLV");
ProcCharacterEnableAllCrimes(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22);
SetHasDialog(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, 1);
CharacterSetCanTrade(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22,1);

IF
DialogEnded("RC_MIL_LoneWolf1", _)
AND
ObjectGetFlag(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, "RC_MIL_CorbinOff", 1)
THEN
ProcCharacterDisappearOutOfSight(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, 0, 0, "", 1);
//END_REGION

IF
CharacterUsedSkillOnTarget(_Player, CHARACTERGUID_S_RC_MIL_MillSupervisor_9d107991-3bb8-4b3a-894a-f17fc83b59f7,_Skill, _, _)
AND
DB_SourceVampirism_Skills(_Skill)
AND
NOT DB_GlobalFlag("RC_MIL_MillSupervisorDead")
THEN
UserSetFlag(_Player, "RC_MIL_KilledMillSupervisor", 0);
GlobalSetFlag("RC_MIL_MillSupervisorDead");

IF
CharacterUsedSkillOnTarget(_Player, CHARACTERGUID_S_RC_MIL_MillOverseer_bd2a58fc-2e61-4a62-b79c-6ff952888fc4 ,_Skill, _, _)
AND
DB_SourceVampirism_Skills(_Skill)
AND
NOT DB_GlobalFlag("RC_MIL_MillSupervisorDead")
THEN
UserSetFlag(_Player, "RC_MIL_KilledMillSupervisor", 0);
GlobalSetFlag("RC_MIL_MillSupervisorDead");

IF
ObjectFlagSet("RC_MIL_GhostLog_Reward", _Player, _)
THEN
SetOnStage(ITEMGUID_S_RC_MIL_LogRewardShield_4a39c5bb-abb6-42d5-b064-f39053b2c43e, 1);
ItemToInventory(ITEMGUID_S_RC_MIL_LogRewardShield_4a39c5bb-abb6-42d5-b064-f39053b2c43e, _Player);
PlayEffect(ITEMGUID_S_RC_MIL_GhostLog_e75084d9-e7c5-4e6b-8b31-d834e7c8747a, "RS3_FX_GP_Impacts_Wood_01");
//OpenMessageBox(_Player, "RC_MIL_GotTreeTalent");
UserSetFlag((CHARACTERGUID)_Player, "QuestUpdate_RC_MIL_GhostLog_GotReward", 0);

PROC
ProcShovelRewards(_, "RC_MIL_Graveyard1")
THEN
SetOnStage(CHARACTERGUID_S_RC_MIL_MillOverseer_bd2a58fc-2e61-4a62-b79c-6ff952888fc4, 1);

IF
ObjectFlagSet("RC_MIL_AskedLoneWolf2", _Player, _)
THEN
ProcShowMarker((CHARACTERGUID)_Player, "RC_MIL_LoneWolf2Cache");
ProcSetPerceptionDifficulty(ITEMGUID_S_RC_MIL_LoneWolf2CachePile_97b20d71-cc63-41e1-bea3-65dd748631a2,"Trivial");

IF
ItemAddedToCharacter(ITEMGUID_S_RC_MIL_SelenHead_468156b2-7c88-4305-bb39-55fcdbdb0652, _Player)
THEN
UserSetFlag(_Player, "QuestUpdate_RC_MIL_SelenHead_GotHead", 0);

IF
DialogEnded("RC_MIL_GuardWolf1Haunt", _ID)
AND
DB_DialogPlayers(_ID, _Player, 1)
AND
ObjectGetFlag(_Player, "RC_MIL_GuardWolf1Haunt_OnFire", 1)
AND
QueryOnlyOnce("RC_MIL_AD_GuardWolf1Haunt_CaughtFire")
THEN
ProcObjectTimer(_Player, "RC_MIL_AD_GuardWolf1Haunt_CaughtFireTimer", 6000);

IF
DialogEnded("RC_MIL_GuardWolf1Haunt", _ID)
AND
DB_DialogPlayers(_ID, _Player, 1)
AND
ObjectGetFlag(_Player, "RC_MIL_GuardWolf1Haunt_OnFire", 1)
THEN
ApplyStatus(_Player, "KNOCKED_DOWN", 4.0, 1);
ApplyStatus(_Player, "BURNING", 4.0, 1);
ObjectClearFlag(_Player, "RC_MIL_GuardWolf1Haunt_OnFire", 0);

PROC
ProcObjectTimerFinished(_Player, "RC_MIL_AD_GuardWolf1Haunt_CaughtFireTimer")
THEN
Proc_StartDialog(1, "RC_MIL_AD_GuardWolf1Haunt_CaughtFire", _Player);

PROC
Proc_DialogFlagSetup("RC_MIL_LoneWolf1",CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22,_Player)
AND
ObjectGetFlag(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22, "RC_MIL_CorbinToLV", 0)
AND
ObjectGetFlag(_Player, "RC_MIL_PersuadedCorbinTrade", _State)
THEN
CharacterSetCanTrade(CHARACTERGUID_S_RC_MIL_LoneWolf1_e6a57615-aee7-46b2-927a-a089ccbfdc22,_State);

//REGION Ghost sucked update fixes
IF
CharacterUsedSkillOnTarget(_Player,(CHARACTERGUID)_Ghost,_Skill,_,_)
AND
DB_SourceVampirism_Skills(_Skill)
AND
DB_RC_MIL_GhostSuckUpdates(_Ghost, _Update)
THEN
PartySetFlag(_Player, _Update);
//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "ReapersCoast"
