Version 1
SubGoalCombiner SGC_AND
INITSECTION
DB_Dialogs(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_001_e066f9e4-122b-4ba2-bdb6-6ba7a79dfde4,"CoS_Temples_MagisterBodyguard_001");
DB_Dialogs(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_002_76ff28ba-2dcd-46aa-8212-980886280795,"CoS_Temples_MagisterBodyguard_002");
DB_Dialogs(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_003_34e18de0-f377-4830-bfce-229ff479ee80,"CoS_Temples_MagisterBodyguard_003");
DB_Dialogs(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_004_f1f0f480-4158-49d0-9d33-7486ac50de2d,"CoS_Temples_MagisterBodyguard_004");
DB_Dialogs(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_005_c3891e16-21be-46ec-a758-68ca373bbf79,"CoS_Temples_MagisterBodyguard_005");


DB_Temples_AlexandarsBattalion((CHARACTERGUID)CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
DB_Temples_AlexandarsBattalion(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_001_e066f9e4-122b-4ba2-bdb6-6ba7a79dfde4);
DB_Temples_AlexandarsBattalion(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_002_76ff28ba-2dcd-46aa-8212-980886280795);
DB_Temples_AlexandarsBattalion(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_003_34e18de0-f377-4830-bfce-229ff479ee80);
DB_Temples_AlexandarsBattalion(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_004_f1f0f480-4158-49d0-9d33-7486ac50de2d);
DB_Temples_AlexandarsBattalion(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_005_c3891e16-21be-46ec-a758-68ca373bbf79);


DB_KillCounter_Internal(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"CoS_AlexandarsBattalion");
DB_KillCounter_Internal(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_001_e066f9e4-122b-4ba2-bdb6-6ba7a79dfde4,"CoS_AlexandarsBattalion");
DB_KillCounter_Internal(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_002_76ff28ba-2dcd-46aa-8212-980886280795,"CoS_AlexandarsBattalion");
DB_KillCounter_Internal(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_003_34e18de0-f377-4830-bfce-229ff479ee80,"CoS_AlexandarsBattalion");
DB_KillCounter_Internal(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_004_f1f0f480-4158-49d0-9d33-7486ac50de2d,"CoS_AlexandarsBattalion");
DB_KillCounter_Internal(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_005_c3891e16-21be-46ec-a758-68ca373bbf79,"CoS_AlexandarsBattalion");
DB_KillCounter("CoS_AlexandarsBattalion",6);



DB_HasStoryEvent((ITEMGUID)ITEMGUID_S_CoS_Temples_AlexandarsHead_e7097370-d786-47e8-8ab4-76528939a1c0,"CoS_HasAlexandarsHead");

DB_KnowsAlexandarIsAlive_Flags("QuestUpdate_CoS_HelpingAlexandar_Start_SavedMagisters");
DB_KnowsAlexandarIsAlive_Flags("QuestUpdate_CoS_HelpingTheSallowMan_Start_Mirror");


DB_CoS_AlexandarSallowManQuests("CoS_HelpingTheSallowMan");
DB_CoS_AlexandarSallowManQuests("CoS_HelpingAlexandar");
KBSECTION
IF
GameStarted("CoS_Main",_)
AND
// instead of QueryOnlyOnce, because that DB is not set for older savegames.
// When inited, Alexandar gets this faction in CoS and it does not change
// there anymore.
NOT GetFaction(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"CoS_Magister")
THEN
SetOnStage(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,1);
TeleportTo(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,TRIGGERGUID_S_CoS_Temples_AlexandarDefault_Point_4337807e-7e2a-4198-a0a6-9098a3e76d90);
Proc_CoS_Temples_AlexandarsBattalion_Init();

PROC
Proc_CoS_Temples_AlexandarsBattalion_Init()
AND
NOT DB_Dead(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349)
THEN
DB_CoS_Temples_AlexandarsBattalion_AlexandarAlive(1);

PROC
Proc_CoS_Temples_AlexandarsBattalion_Init()
AND
DB_Dead(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349)
THEN
DB_CoS_Temples_AlexandarsBattalion_InitResurrecting(1);
CharacterResurrect(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);

IF
CharacterResurrected(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349)
AND
DB_CoS_Temples_AlexandarsBattalion_InitResurrecting(1)
THEN
NOT DB_CoS_Temples_AlexandarsBattalion_InitResurrecting(1);
DB_CoS_Temples_AlexandarsBattalion_AlexandarAlive(1);

IF
DB_CoS_Temples_AlexandarsBattalion_AlexandarAlive(1)
THEN
NOT DB_CoS_Temples_AlexandarsBattalion_AlexandarAlive(1);
CharacterSetHitpointsPercentage(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,100.0);
CharacterSetArmorPercentage(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,100.0);
CharacterSetMagicArmorPercentage(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,100.0);
Transform(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"289e11eb-246c-4c89-8acb-b28c08a00a77",0,0,1);
SetFaction(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"CoS_Magister");
SetCanFight(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,1);
SetCanJoinCombat(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,1);
ProcCharacterEnableAllCrimes(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
CharacterSetCanSpotSneakers(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,1);
SetVarFixedString(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"currentState","State_CoS_AtElfTemple");
ClearVarObject(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"SpotTrigger");
DB_NoLowAttitudeDialog(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
CharacterSetImmortal(S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,0);
PROC_RemoveDialogFromCharacter(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
NOT DB_Dead(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
DB_Dialogs(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"CoS_Temples_Alexandar");
CharacterLevelUpTo(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,16);
RemoveStatus(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"SOURCE_MUTED");
RemoveStatus(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"SLEEPING");
RemoveStatus(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"HALL_OF_ECHOES");
CharacterDisableCrime(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"SourceMagic");
//CharacterDisableCrime(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"ActiveUndead");
RemoveStatus(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"HALL_OF_ECHOES");
ApplyStatus(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"QUEST_FAITH_AURA",-1.0,1);
CharacterRemoveSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Shout_EnemyInspire");
CharacterRemoveSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Shout_EnemyElectricFence");
CharacterRemoveSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Shout_EnemyBlindingRadiance");
CharacterRemoveSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"ProjectileStrike_EnemyDazingBolt");
CharacterRemoveSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Teleportation_EnemyNetherswap");
CharacterAddSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Rain_EnemyWater");
CharacterAddSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Cone_EnemySteamLance");
CharacterAddSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Target_EnemyBless_Alexandar");
CharacterAddSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Teleportation_EnemyResurrect_Alexandar");
CharacterAddSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Target_EnemyRestoration");
CharacterAddSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Projectile_EnemyChainHeal");
CharacterAddSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Target_EnemyFortify");
CharacterAddSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Target_EnemyFrostyShell");
CharacterAddSkill(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"Shout_EnemyWings");
ItemTemplateAddTo("f7ecad76-b074-4164-a99f-9262d3cd66db",CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,3); //holy grenade x3
ItemTemplateAddTo("60180909-ee47-4d1c-b81c-e43bd8fdce1e",CHARACTERGUID_S_FTJ_SW_Warrior_SeekerCaptain_1329f018-23e4-4717-9bc8-074b28d04c54,1); //rez scroll x1
SetTag(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,"AI_PREFERRED_TARGET");
DB_Ghosts(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,
						CHARACTERGUID_S_CoS_Temples_Alexandar_Ghost_997e2611-fbdc-415f-9d42-f2c9926d91f6,"CoS_Temples_Alexandar_Ghost");
TimerLaunch("CoS_RestoreAlexandarGhostDialog",2000);

IF
TimerFinished("CoS_RestoreAlexandarGhostDialog")
AND
DB_GoneGhosts(CHARACTERGUID_S_CoS_Temples_Alexandar_Ghost_997e2611-fbdc-415f-9d42-f2c9926d91f6)
THEN
NOT DB_GoneGhosts(CHARACTERGUID_S_CoS_Temples_Alexandar_Ghost_997e2611-fbdc-415f-9d42-f2c9926d91f6);
DB_Dialogs(CHARACTERGUID_S_CoS_Temples_Alexandar_Ghost_997e2611-fbdc-415f-9d42-f2c9926d91f6,"CoS_Temples_Alexandar_Ghost");


IF
DB_Temples_AlexandarsBattalion((CHARACTERGUID)_Magister)
THEN
CharacterDisableCrime(_Magister,"SourceMagic");
CharacterDisableCrime(_Magister,"ActiveUndead");


//Regenerate Loot
IF
CharacterDying(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349)
AND
CharacterGetLevel(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,_Level)
THEN
GenerateTreasure(ITEMGUID_S_CoS_HelperChest_d4a2dbc7-7734-4605-be18-ef79716f641f,"COS_AlexandarStaff",_Level,CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
GenerateTreasure(ITEMGUID_S_CoS_HelperChest_d4a2dbc7-7734-4605-be18-ef79716f641f,"COS_DispelCowl",_Level,CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
MoveAllItemsTo(ITEMGUID_S_CoS_HelperChest_d4a2dbc7-7734-4605-be18-ef79716f641f,CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
ProcCancelReflectionDialog("CoS_Temples_Elf_CORE_RD_ShouldAlexandarBeDivine");
ProcCancelReflectionDialog("CoS_Temples_RD_AlexandarIsAlive");

//Killed Alex Flag
IF
CharacterKilledBy(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,_AttackerOwner,_Attacker)
AND
DB_IsPlayer(_AttackerOwner)
THEN
ObjectSetFlag(_AttackerOwner,"CoS_Temples_KilledAlexandar");


//REGION Knows Alex is Alive

IF
ObjectFlagSet(_Flag,_Player,_)
AND
DB_KnowsAlexandarIsAlive_Flags(_Flag)
THEN
ObjectSetFlag(_Player,"CoS_Temples_KnowsAlexandarIsAlive");

IF
ObjectFlagSet("CoS_Temples_KnowsAlexandarIsAlive",(CHARACTERGUID)_Player,_ID)
AND
GlobalGetFlag("CoS_AlexandarDead",0)
THEN
ProcDefineReflectionDialog("CoS_Temples_RD_AlexandarIsAlive",_Player);

//END_REGION


IF
DialogEnded("CoS_Temples_Alexandar",_Id)
AND
DialogGetInvolvedPlayer(_Id,1,(CHARACTERGUID)_Player)
AND
QueryOnlyOnce("CoS_Temples_Elf_CORE_RD_ShouldAlexandarBeDivine")
THEN
ProcDefineReflectionDialog("CoS_Temples_Elf_CORE_RD_ShouldAlexandarBeDivine",_Player);


//Magister start dialog on Sight
IF
StoryEvent(_Player,"CoS_Temples_ApprochAlexandarDialog_Start")
AND
GlobalGetFlag("CoS_GarethRevenge_SceneActive",0)
AND
QRY_SpeakerIsAvailable(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349)
THEN
Proc_StartDialog(0,"CoS_Temples_ApproachedAlexandar",CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_003_34e18de0-f377-4830-bfce-229ff479ee80,CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,_Player);


//Dialog move to
IF
ObjectFlagSet("S_CoS_Temples_MagisterBodyguard_003_MoveToPlayer",_Player,_)
THEN
ProcCharacterMoveTo(CHARACTERGUID_S_CoS_Temples_MagisterBodyguard_003_34e18de0-f377-4830-bfce-229ff479ee80,_Player,0,"");
ObjectClearFlag(_Player,"S_CoS_Temples_MagisterBodyguard_003_MoveToPlayer",0);

IF
CharacterDied(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349)
AND
GetRegion(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,_Region)
AND
_Region == "CoS_Main"
THEN
SetOnStage(ITEMGUID_S_CoS_Temples_AlexandarsHead_e7097370-d786-47e8-8ab4-76528939a1c0,1);
ItemToInventory(ITEMGUID_S_CoS_Temples_AlexandarsHead_e7097370-d786-47e8-8ab4-76528939a1c0,CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);


IF
CharacterDied(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349)
AND
GetRegion(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,_Region)
AND
_Region == "CoS_Main"
THEN
GlobalSetFlag("CoS_AlexandarDead");


IF
ObjectFlagSet("QuestUpdate_CoS_HelpingAlexandar_Start",_Player,_)
THEN
ObjectSetFlag(_Player,"QuestUpdate_CoS_Temples_Alexandar");



IF
GlobalFlagSet("CoS_AlexandarDead")
AND
DB_IsPlayer(_Player)
AND
DB_CoS_AlexandarSallowManQuests(_Quest)
AND
QuestAccepted(_Player,_Quest,1)
THEN
ObjectSetFlag(_Player,"CoS_AlexandarIsDeadQuestUpdater");
ProcHideMarker(_Player,"CoS_Alexandar");

IF
ObjectFlagSet("CoS_GiveDispellIllusionItem",(CHARACTERGUID)_Player,_)
THEN
CharacterGiveReward(_Player,"COS_DispelCowl");
ObjectClearFlag(_Player,"CoS_GiveDispellIllusionItem",0);

//Eating Alexandar's Head
IF
CharacterItemEvent((CHARACTERGUID)_Player,ITEMGUID_S_CoS_Temples_AlexandarsHead_e7097370-d786-47e8-8ab4-76528939a1c0,"GLO_AteBodyPart")
THEN
Proc_StartDialog(0,"CoS_Temples_Alexandar_Limb",_Player);

IF
CharacterUsedItem((CHARACTERGUID)_Player,ITEMGUID_S_CoS_Temples_AlexandarsHead_e7097370-d786-47e8-8ab4-76528939a1c0)
THEN
ObjectSetFlag(_Player,"QuestUpdate_CoS_HelpingTheSallowMan_AteAlexandarHead");

IF
CharacterEnteredTrigger((CHARACTERGUID)_Player,TRIGGERGUID_S_CoS_SUB_Academy_51ddb828-18a6-4b6e-9f5a-e2b2883862e1)
AND
DB_IsPlayer(_Player)
AND
GlobalGetFlag("CoS_Temples_AlexandarLeaveToAcademy",0)
THEN
GlobalSetFlag("CoS_Temples_AlexandarLeaveToAcademy");


IF
GlobalFlagSet("CoS_Temples_AlexandarLeaveToAcademy")
AND
DB_Temples_AlexandarsBattalion((CHARACTERGUID)_Char)
AND
_Char != CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349
AND
CharacterIsDead(_Char,0)
THEN
SetHasDialog(_Char,0);
ProcCharacterDisappearOutOfSight(_Char,90,0,"CoS_LastStandCheck",0);

IF
GlobalFlagSet("CoS_Temples_AlexandarLeaveToAcademy")
AND
QueryOnlyOnce("CoS_Temples_AlexandarLeaveToAcademy_Once")
THEN
ProcForceStopDialog(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
PROC_RemoveDialogFromCharacter(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349);
ProcCharacterDisappearOutOfSight(CHARACTERGUID_S_GLO_Alexandar_03e6345f-1bd3-403c-80e2-a443a74f6349,90,0,"CoS_AlexandarAppearInTemple",0);



IF
GlobalFlagSet("CoS_Temples_AlexandarLeaveToAcademy")
AND
DB_IsPlayer(_Player)
THEN
ObjectSetFlag(_Player,"QuestUpdate_CoS_HelpingAlexandar_Leave");

//REGION ARX2-846 
//Quest closed in Elf Temple
IF
ObjectFlagSet("QuestUpdate_CoS_HelpingAlexandar_Leave",(CHARACTERGUID)_Player,_Id)
AND
PartyGetFlag(_Player,"QuestUpdate_CoS_HelpingAlexandar_End",1)
THEN
ObjectSetFlag(_Player,"CoS_AlexandarQuestClose");

//END_REGION

//REGION DOSTWO-27981 
//Quest closed in Elf Temple
IF
ObjectFlagSet("QuestUpdate_CoS_HelpingAlexandar_End",(CHARACTERGUID)_Player,_Id)
AND
NOT DB_QuestDef_CloseEvent("CoS_HelpingAlexandar","QuestUpdate_CoS_HelpingAlexandar_End")
THEN
DB_QuestDef_CloseEvent("CoS_HelpingAlexandar","QuestUpdate_CoS_HelpingAlexandar_End");

//Alex die, swap ATM for time
PROC
ReactOnKillCounter("CoS_AlexandarsBattalion")
THEN
TriggerSetAtmosphere(TRIGGERGUID_AtmosphereTrigger_CoS_AlexandarsBatallion_10ae0a87-4bb7-481d-9f0c-dd632152bc82,"cd788e05-f2c8-41f0-ab53-be5c19a217a0"); //Rain
TimerLaunch("CoS_AlexandarsBattalion_RainResetTimer",300000);

IF
TimerFinished("CoS_AlexandarsBattalion_RainResetTimer")
THEN
TriggerSetAtmosphere(TRIGGERGUID_AtmosphereTrigger_CoS_AlexandarsBatallion_10ae0a87-4bb7-481d-9f0c-dd632152bc82,"6b647fc9-1f97-4f53-840e-656506d8d19f");

PROC
ProcRegionEnded("CoS_Main")
THEN
GoalCompleted;
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "CoS_Temples"
