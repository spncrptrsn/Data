Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION
///////////////////////////////////////////////////////////////////////
// Story call to forward the clock to _NewHour.
// The clock will be advanced with max 24 hours. This happens when you call SetGameClock(_H) AND Time(_,_H,_).
//
// DO NOT USE THE ENGINE CALL SetTime DIRECTLY!
//
PROC	
SetGameClock((INTEGER)_NewHour) 
AND
DB_Time(_Day,_H,_)
AND 
_NewHour > _H
// day stays today
THEN
UpdateTime(_Day,_NewHour);

PROC
SetGameClock((INTEGER)_NewHour) 
AND
DB_Time(_Day,_H,_) 
AND
_NewHour <= _H 
AND
// day forwards +1
IntegerSum(_Day,1,_DayP1)
THEN	
UpdateTime(_DayP1,_NewHour);

PROC
ProcDisableFollow((CHARACTERGUID)_Char)
THEN
CharacterDetachFromGroup(_Char);
//CharacterLockGroup(_Char,1);

IF
CharacterUsedItemFailed(_Player,_Item)
AND
_Player.DB_IsPlayer()
THEN
ProcShowForbiddenItemText(_Player,_Item);

PROC
ProcShowForbiddenItemText((CHARACTERGUID)_Player,(ITEMGUID)_Item)
AND
ItemIsLocked(_Item, 0)
AND
NOT DB_NoForbiddenText(_Item)
THEN
Proc_StartDialog(1,"GLO_AD_ForbiddenItem",_Player);

PROC
ProcShowForbiddenItemText((CHARACTERGUID)_Player,(ITEMGUID)_Item)
AND
ItemIsLocked(_Item, 1)
THEN
CharacterItemSetEvent(_Player, _Item, "GLO_UsedLockedItem");

PROC
ProcShowMarker((CHARACTERGUID)_Player,(STRING)_Marker)
AND
NOT DB_ActivePlayerMarker(_Player,_Marker)
THEN
DB_ActivePlayerMarker(_Player,_Marker);
ShowMapMarker(_Player,_Marker,1);

PROC
ProcHideMarker((CHARACTERGUID)_Player,(STRING)_Marker)
AND
DB_ActivePlayerMarker(_Player,_Marker)
THEN
ShowMapMarker(_Player,_Marker,0);

PROC
ProcFreezePlayers()
AND
_Player.DB_IsPlayer()
THEN
CharacterFreeze(_Player);

PROC
ProcUnfreezePlayers()
AND
_Player.DB_IsPlayer()
THEN
CharacterUnfreeze(_Player);

//REGION moving items default functions 
PROC
MoveAllItemsTo((GUIDSTRING)_Source,(GUIDSTRING)_Target)
THEN
MoveAllItemsTo(_Source,_Target,1,1,1);
//END_REGION
EXITSECTION

ENDEXITSECTION
