Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION
// Needs to be first because otherwise you get into endless loops in case there is an ObjectFlagSet()
// handler that clears the flag before the ones below get executed (as they would then set the flag
// again, causing the clear to be re-triggered, etc)

//REGION Dialogs in which flags are always shared across all shapeshift forms of everyone involved
// Flag set in a shared flags dialog -> set for all shapeshift forms
IF
ObjectFlagSet(_Flag,_Char,_ID)
AND
DB_GLO_AllDialogObjectFlagsShared(_ID)
THEN
// Once shared, shared forever (also for clearing)
DB_SharedObjectFlags(_Flag);
ObjectSetFlag(_Char,_Flag);
//END_REGION

//REGION Object flag transfer to shapeshift forms
IF
ObjectFlagSet(_Flag,(CHARACTERGUID)_Player,_)
AND
DB_IsPlayer(_Player)
AND
DB_SharedObjectFlags(_Flag)
THEN
ObjectSetFlag(_Player,_Flag);

IF
ObjectFlagCleared(_Flag,(CHARACTERGUID)_Player,_)
AND
DB_IsPlayer(_Player)
AND
DB_SharedObjectFlags(_Flag)
THEN
ObjectClearFlag(_Player,_Flag);

//END_REGION
EXITSECTION

ENDEXITSECTION