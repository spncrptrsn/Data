Version 1
SubGoalCombiner SGC_AND
INITSECTION

KBSECTION
PROC
ProcClearAutomatedDialog((INTEGER)_Inst)
THEN
ProcClearDialogPlayers(_Inst);
ProcClearDialogNPCs(_Inst);
ProcClearDialogCounts(_Inst);
NOT DB_AutomatedDialog(_Inst);

IF
VoiceBarkEnded(_,_Inst)
THEN
NOT DB_AutomatedDialogIsVB(_Inst);
ProcClearAutomatedDialog(_Inst);

IF
AutomatedDialogEnded(_,_Inst)
AND
NOT DB_AutomatedDialogIsVB(_Inst)
THEN
ProcClearAutomatedDialog(_Inst);

IF
AutomatedDialogEnded(_Dialog,_Inst)
THEN
NOT DB_DialogName(_Dialog,_Inst);
NOT DB_DialogRequestFailed(_Dialog,_Inst);

IF
DialogEnded(_Dialog,_Inst)
THEN
ProcClearDialogPlayers(_Inst);
ProcClearDialogNPCs(_Inst);
ProcClearDialogCounts(_Inst);
NOT DB_DialogName(_Dialog,_Inst);
NOT DB_MarkedForDelete(_Inst);
NOT DB_DialogRequestFailed(_Dialog,_Inst);

IF
DialogActorLeft(_Dialog,_Inst,_Actor)
AND
DB_DialogPlayers(_Inst,_Actor,_Index)
THEN
NOT DB_DialogPlayers(_Inst,_Actor,_Index);
ProcClearPlayerIfNotInOtherDialog(_Inst,_Actor);

IF
DialogActorLeft(_Dialog,_Inst,_Actor)
AND
DB_DialogNPCs(_Inst,_Actor,_Index)
THEN
NOT DB_DialogNPCs(_Inst,_Actor,_Index);
ProcClearNPCIfNotInOtherDialog(_Inst,_Actor);

IF
DialogActorLeft(_Dialog,_Inst,_Actor)
THEN
ProcSetNumberOfInvolvedActors(_Inst);

PROC
ProcClearDialogPlayers((INTEGER)_Inst)
AND
DB_DialogPlayers(_Inst,_Player,_Index)
THEN
NOT DB_DialogPlayers(_Inst,_Player,_Index);

PROC
ProcClearDialogNPCs((INTEGER)_Inst)
AND
DB_DialogNPCs(_Inst,_Player,_Index)
THEN
NOT DB_DialogNPCs(_Inst,_Player,_Index);

PROC
ProcClearDialogCounts((INTEGER)_Inst)
AND
DB_DialogNumPlayers(_Inst,_NumPlayers)
AND
DB_DialogNumNPCs(_Inst,_NumNPCs)
THEN
NOT DB_DialogNumPlayers(_Inst,_NumPlayers);
NOT DB_DialogNumNPCs(_Inst,_NumNPCs);

IF
CharacterCreationFinished(_)
THEN
NOT DB_InCharacterCreation(1);
NotifyCharacterCreationFinished();
EXITSECTION

ENDEXITSECTION
